<%= render "users/header" %>

<div class="book-show-body">
	<div class="container">
		<!--notice-->
		<p></p>
		<div class="row">
			<%= render "users/info" %>
			<div class="col-lg-9">
				<h2>Book detail</h2>

				<!--ログイン中ユーザーのid == Bookのuser_id-->
				<% if current_user.id == @book_show.user_id %>
				<table class="table">
					<tbody>
						<tr>
							<td>
								<% i = @users.find(@book_show.user_id) %>
								<% if i.profile_image_id != nil %> <!--Userの画像がある場合-->
								<!--refileなので profile_imageの_idは抜く-->
									<%= image_tag attachment_url(i, :profile_image, :fill, 100, 100) %>
								<% else %> <!--Userの画像がない場合-->
									<%= image_tag 'no-image.jpg', size: '40x40' %>
								<% end %>
							</td>
							<td><%= link_to @book_show.title, book_path(@book_show.id) %></td>
							<td><%= @book.body %></td>
							<td><%= link_to "Edit",edit_book_path(@book_show.id) %></td>
							<td><%= link_to "Destroy", book_path(@book_show.id), method: :delete,data: {confirm: "本当に消しますか？"} %></td>
						</tr>
					</tbody>
				</table>

				<!--ログイン中のユーザーのid != Bookのuser_id-->
				<% else %>
				<table class="table">
					<tbody>
						<tr>
							<td>
								<% i = @users.find(@book.user_id) %>
								<% if i.profile_image_id != nil %> <!--Userの画像がある場合-->
								<!--refileなので profile_imageの_idは抜く-->
									<%= image_tag attachment_url(i, :profile_image, :fill, 100, 100) %>
								<% else %> <!--Userの画像がない場合-->
									<%= image_tag 'no-image.jpg', size: '40x40' %>
								<% end %>
								<%= link_to i.name, user_path(i.id) %>
							</td>
							<td><%= link_to @book.title, book_path(@book.id) %></td>
							<td><%= @book.body %></td>
						</tr>
					</tbody>
				</table>
				<% end %>

			</div> <!--col-9-->
		</div> <!--row-->
	</div> <!--container-->
</div>

<%= render "users/footer" %>